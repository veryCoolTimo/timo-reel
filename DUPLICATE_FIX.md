# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –≤–∏–¥–µ–æ

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞
–ë–æ—Ç —Å–∫–∞—á–∏–≤–∞–ª –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ –≤–∏–¥–µ–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑, –µ—Å–ª–∏ –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ –±—ã–ª–∏ —Å—Å—ã–ª–∫–∏ –Ω–∞ –æ–¥–Ω–æ –≤–∏–¥–µ–æ —Å —Ä–∞–∑–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:

```
https://www.instagram.com/reel/DKKVxDUT6-U/
https://www.instagram.com/reel/DKKVxDUT6-U/?utm_source=ig_web_copy_link
```

## ‚úÖ –†–µ—à–µ–Ω–∏–µ
–î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏ —Å—Å—ã–ª–æ–∫ –≤ `backend/handlers/link_handler.py`:

### 1. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è URL
```python
def normalize_url(url: str) -> str:
    """–£–±–∏—Ä–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞ –∏ –ª–∏—à–Ω–∏–µ —Å–∏–º–≤–æ–ª—ã"""
    parsed = urlparse(url)
    normalized = f"{parsed.scheme}://{parsed.netloc}{parsed.path}"
    if normalized.endswith('/'):
        normalized = normalized[:-1]
    return normalized
```

### 2. –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –ø—Ä–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏–∏
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —É–∂–µ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö URL —á–µ—Ä–µ–∑ `set()`
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –≤–µ—Ä—Å–∏–π —Å—Å—ã–ª–æ–∫
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –≤–∏–¥–µ–æ

### 3. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ
- –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã –ø–µ—Ä–µ–¥ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ–º
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –û—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –¥—É–±–ª–∏—Ä—É—é—â–∏–º–∏—Å—è —Å—Å—ã–ª–∫–∞–º–∏:
```
https://www.instagram.com/reel/ABC123/
https://www.instagram.com/reel/ABC123/?utm_source=ig_web_copy_link
https://www.instagram.com/reel/ABC123/?igshid=xyz
```

### –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:
- ‚úÖ –ë–æ—Ç –Ω–∞–π–¥–µ—Ç 3 —Å—Å—ã–ª–∫–∏
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ 1 —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –≤–∏–¥–µ–æ
- ‚úÖ –í –ª–æ–≥–∞—Ö: "Found 1 unique video URLs"
- ‚úÖ –í –ª–æ–≥–∞—Ö: "Skipping duplicate URL"

## üìä –õ–æ–≥–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```
Found 2 video URLs in message from user 112211524
Downloading video: Video by champa.chii from https://www.instagram.com/reel/DKKVxDUT6-U/
Downloading video: Video by champa.chii from https://www.instagram.com/reel/DKKVxDUT6-U/?utm_source=ig_web_copy_link
```

**–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```
Found 1 unique video URLs in message from user 112211524
Downloading video: Video by champa.chii from https://www.instagram.com/reel/DKKVxDUT6-U/
Skipping duplicate URL: https://www.instagram.com/reel/DKKVxDUT6-U/?utm_source=ig_web_copy_link
```

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **–≠–∫–æ–Ω–æ–º–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤** - –Ω–µ —Å–∫–∞—á–∏–≤–∞–µ–º –æ–¥–Ω–æ –≤–∏–¥–µ–æ –¥–≤–∞–∂–¥—ã
2. **–õ—É—á—à–∏–π UX** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã
3. **–ú–µ–Ω—å—à–µ —Å–ø–∞–º–∞** - —á–∞—Ç –Ω–µ –∑–∞—Å–æ—Ä—è–µ—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–∞–º–∏
4. **–≠–∫–æ–Ω–æ–º–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞** - –º–µ–Ω—å—à–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ Instagram/TikTok

## ‚öôÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `urllib.parse` –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ URL
- –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –¥–≤—É—Ö —É—Ä–æ–≤–Ω—è—Ö:
  1. –ü—Ä–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏–∏ —Å—Å—ã–ª–æ–∫ –∏–∑ —Ç–µ–∫—Å—Ç–∞
  2. –ü—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∫–∞–∂–¥–æ–π —Å—Å—ã–ª–∫–∏
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å–µ —Ç–∏–ø—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ URL (utm_source, igshid, etc.)
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ
**–í–µ—Ä—Å–∏—è:** TimoReel v1.0 (–≠—Ç–∞–ø 4) 