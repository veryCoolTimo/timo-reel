# –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å Instagram –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö

## –ü—Ä–æ–±–ª–µ–º–∞

–ù–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö Instagram —á–∞—Å—Ç–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É –≤–∏–¥–µ–æ –∏–∑-–∑–∞:
- Rate-limit (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤)
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö IP –∞–¥—Ä–µ—Å–æ–≤
- –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –ê–Ω—Ç–∏–±–æ—Ç –∑–∞—â–∏—Ç–∞

**–û—à–∏–±–∫–∞ –≤ –ª–æ–≥–∞—Ö:**
```
ERROR: [Instagram] DKJzBhlJJ7i: Requested content is not available, rate-limit reached or login required
```

## –†–µ—à–µ–Ω–∏—è

### üîß –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É:**
```bash
cd backend
python instagram_diagnostic.py
```

2. **–ü–æ–ª—É—á–∏—Ç–µ cookies –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞:**
```bash
python get_instagram_cookies.py
```

3. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:**
```bash
python run_background.py restart
```

### üõ†Ô∏è –ü–æ–¥—Ä–æ–±–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

#### 1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Cookies (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
```bash
cd backend
python get_instagram_cookies.py
```

**–í—Ä—É—á–Ω—É—é:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ Instagram –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç
3. –û—Ç–∫—Ä–æ–π—Ç–µ Developer Tools (F12)
4. Network ‚Üí –Ω–∞–π–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –∫ instagram.com
5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ Cookie –∑–∞–≥–æ–ª–æ–≤–æ–∫
6. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≤ `backend/cookies/instagram.txt`

#### 2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ yt-dlp

```bash
pip install -U yt-dlp
```

#### 3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∫—Å–∏

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `backend/downloader/instagram_fix.py`:
```python
PROXY_LIST = [
    'http://user:pass@proxy1.com:8080',
    'http://user:pass@proxy2.com:8080',
]
```

#### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–¥–µ—Ä–∂–µ–∫

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏:
- 2-5 —Å–µ–∫—É–Ω–¥ –º–µ–∂–¥—É –æ–±—ã—á–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏
- 3-6 —Å–µ–∫—É–Ω–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –ø—Ä–∏ rate-limit

### üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤:**
```bash
# –û–±—â–∏–µ –ª–æ–≥–∏ –±–æ—Ç–∞
tail -f backend/logs/bot.log

# –û—à–∏–±–∫–∏ Instagram
tail -f backend/logs/instagram_errors.log

# –ü–æ–∏—Å–∫ rate-limit –æ—à–∏–±–æ–∫
grep "rate-limit" backend/logs/bot.log
```

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—à–∏–±–æ–∫:**
```bash
# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫ –∑–∞ —Å–µ–≥–æ–¥–Ω—è
grep "$(date +%Y-%m-%d)" backend/logs/instagram_errors.log | wc -l

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 10 –æ—à–∏–±–æ–∫
tail -10 backend/logs/instagram_errors.log
```

### üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

**–ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
```bash
cd backend
python instagram_diagnostic.py
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å—Å—ã–ª–∫–∏:**
```bash
cd backend
python -c "
from downloader.video_downloader import downloader
result = downloader.extract_info('YOUR_INSTAGRAM_URL')
print('Success!' if result else 'Failed!')
"
```

### üåê –°–µ—Ä–≤–µ—Ä–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

**–ü—Ä–æ–±–ª–µ–º—ã —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö IP:**
- VPS/Cloud IP —á–∞—Å—Ç–æ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ residential –ø—Ä–æ–∫—Å–∏
- –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ —Å–º–µ–Ω—É –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Å–µ—Ä–≤–µ—Ä–æ–≤:**
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ cookies
- –î–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–∫—Å–∏
- –£–≤–µ–ª–∏—á—å—Ç–µ –∑–∞–¥–µ—Ä–∂–∫–∏
- –†–æ—Ç–∏—Ä—É–π—Ç–µ User-Agent

### üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

**Cookies:**
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –¥–µ–ª–∏—Ç–µ—Å—å cookies —Ñ–∞–π–ª–∞–º–∏
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç –¥–ª—è –±–æ—Ç–∞
- –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ cookies
- –î–æ–±–∞–≤—å—Ç–µ `cookies/` –≤ `.gitignore`

**–ü—Ä–æ–∫—Å–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞–¥–µ–∂–Ω—ã–µ –ø—Ä–æ–∫—Å–∏ —Å–µ—Ä–≤–∏—Å—ã
- –ò–∑–±–µ–≥–∞–π—Ç–µ –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö –ø—Ä–æ–∫—Å–∏
- –†–æ—Ç–∏—Ä—É–π—Ç–µ –ø—Ä–æ–∫—Å–∏ —Ä–µ–≥—É–ª—è—Ä–Ω–æ

### üìà –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞:**
```python
# –í instagram_fix.py
'format': 'best[height<=720]',  # –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞
'socket_timeout': 60,           # –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π —Ç–∞–π–º–∞—É—Ç
```

**–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–µ—à–∏—Ä—É–µ—Ç —É—Å–ø–µ—à–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- –ò–∑–±–µ–≥–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ —Ç–µ–º –∂–µ URL

### üö® Troubleshooting

**–û—à–∏–±–∫–∞: "No cookies file found"**
```bash
python get_instagram_cookies.py
```

**–û—à–∏–±–∫–∞: "Rate limit detected"**
- –ü–æ–¥–æ–∂–¥–∏—Ç–µ 10-15 –º–∏–Ω—É—Ç
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ cookies
- –î–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–∫—Å–∏

**–û—à–∏–±–∫–∞: "Login required"**
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ cookies
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å cookies

**–û—à–∏–±–∫–∞: "IP blocked"**
- –°–º–µ–Ω–∏—Ç–µ IP/–ø—Ä–æ–∫—Å–∏
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ VPN
- –ü–æ–¥–æ–∂–¥–∏—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–∞—Å–æ–≤

### üìù –õ–æ–≥–∏ –∏ –æ—Ç–ª–∞–¥–∫–∞

**–í–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–¥—Ä–æ–±–Ω—ã—Ö –ª–æ–≥–æ–≤:**
```python
# –í bot.py –¥–æ–±–∞–≤—å—Ç–µ:
logging.getLogger('downloader.video_downloader').setLevel(logging.DEBUG)
logging.getLogger('downloader.instagram_fix').setLevel(logging.DEBUG)
```

**–ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫:**
```bash
# –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –æ—à–∏–±–æ–∫ –ø–æ —Ç–∏–ø—É
grep -o "ERROR:.*" backend/logs/bot.log | sort | uniq -c

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏
grep "rate-limit" backend/logs/bot.log | cut -d' ' -f1-2 | sort | uniq -c
```

### üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –ü—Ä–æ–±—É–µ—Ç fallback –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –î–æ–±–∞–≤–ª—è–µ—Ç –∑–∞–¥–µ—Ä–∂–∫–∏ –ø—Ä–∏ rate-limit
- –†–æ—Ç–∏—Ä—É–µ—Ç User-Agent —Å—Ç—Ä–æ–∫–∏
- –õ–æ–≥–∏—Ä—É–µ—Ç –æ—à–∏–±–∫–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

### üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç—Å—è:

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–æ–ª–Ω—É—é –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –æ—à–∏–±–æ–∫
3. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ cookies –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ
4. –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∫—Å–∏
5. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å –¥—Ä—É–≥–æ–≥–æ IP

**–ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:**
```bash
# –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
python instagram_diagnostic.py

# –ü–æ–ª—É—á–µ–Ω–∏–µ cookies
python get_instagram_cookies.py

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å –Ω–æ–≤—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
python run_background.py restart

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤
tail -f logs/bot.log | grep -i instagram
``` 